<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mi Hub de Proyectos ‚Äî Portafolio</title>
  <style>
    /* Reset & Fonts */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;}
    body{
      font-family:'Inter', ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; 
      background: #020617;
      color: #e6eef8;
      overflow-x: hidden;
    }

    /* --- CONTENEDOR PRINCIPAL Y CABECERA --- */
    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      padding-bottom: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    .header h1 {
      font-size: 28px;
      background: linear-gradient(45deg, #a78bfa, #06b6d4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .btn {
      padding: 10px 18px;
      border-radius: 8px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      cursor: pointer;
      color: #e6eef8;
      font-weight: 600;
      transition: all 0.2s;
    }
    .btn:hover {
      background: rgba(255,255,255,0.1);
      border-color: #a78bfa;
    }

    /* --- PARRILLA DE PROYECTOS --- */
    .project-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
    }
    
    /* --- ESTILO DE LA TARJETA DE PROYECTO --- */
    .project-card {
      background: linear-gradient(135deg, #0f172a, #13203c);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 24px;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      opacity: 0;
      transform: translateY(20px);
      animation: cardFadeIn 0.5s ease-out forwards;
    }
    .project-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 40px rgba(167, 139, 250, 0.15);
    }
    .project-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -150%;
      width: 75%;
      height: 100%;
      background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0) 100%);
      transform: skewX(-25deg);
      transition: left 0.75s ease;
    }
    .project-card:hover::before {
      left: 150%;
    }
    .card-header { display: flex; align-items: center; gap: 16px; margin-bottom: 16px; }
    .card-icon { font-size: 36px; }
    .card-title { font-size: 20px; font-weight: 600; color: #fff; }
    .card-desc { font-size: 14px; color: rgba(230, 238, 248, 0.7); line-height: 1.6; }

    @keyframes cardFadeIn {
      to { opacity: 1; transform: translateY(0); }
    }

    /* --- MODAL --- */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,.8);display:none;align-items:center;justify-content:center;padding:28px;backdrop-filter:blur(5px);z-index:100}
    .modal{width:500px;max-width:96%;background:#0f172a;border-radius:12px;padding:24px;border:1px solid rgba(255,255,255,.1);box-shadow:0 10px 30px rgba(0,0,0,0.3)}
    .modal h2{margin-bottom:20px;font-size:22px}
    .form-group{margin-bottom:12px}
    .form-group input{width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,.1);background:rgba(2,6,23,.5);color:inherit;font-size:14px}
    .modal-actions{display:flex;gap:12px;justify-content:flex-end;margin-top:20px}

    /* --- NUEVO: ESTILOS DEL MEN√ö CONTEXTUAL --- */
    .context-menu{position:absolute;display:none;background:#13203c;border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:6px;box-shadow:0 8px 24px rgba(2,6,23,.7);z-index:1000;backdrop-filter:blur(4px)}
    .context-menu ul{list-style:none;margin:0;padding:0}
    .context-menu li{padding:8px 14px;cursor:pointer;border-radius:6px;font-size:14px;white-space:nowrap;}
    .context-menu li:hover{background:rgba(167,139,250,.2)}
    .context-menu li.delete{color:#f472b6}
    .context-menu li.delete:hover{background:rgba(244,114,182,.2)}

  </style>
</head>
<body>
  
  <div class="container">
    <div class="header">
      <h1>Mis Proyectos</h1>
      <button id="addBtn" class="btn">‚ûï Agregar Proyecto</button>
    </div>

    <div id="project-grid" class="project-grid">
      </div>
  </div>

  <div id="modal" class="modal-backdrop">
    <div class="modal">
      <h2 id="modalTitle"></h2>
      <div class="form-group"><input id="pTitle" placeholder="T√≠tulo del proyecto"/></div>
      <div class="form-group"><input id="pURL" placeholder="URL completa (https://...)"/></div>
      <div class="form-group"><input id="pDesc" placeholder="Descripci√≥n corta del proyecto"/></div>
      <div class="form-group"><input id="pIcon" placeholder="√çcono (un solo emoji, ej: üöÄ)"/></div>
      <div class="modal-actions">
        <button id="cancel" class="btn">Cancelar</button>
        <button id="save" class="btn">Guardar</button>
      </div>
    </div>
  </div>
  
  <div id="contextMenu" class="context-menu">
    <ul>
      <li data-action="open_new_tab">üöÄ Abrir en Pesta√±a Nueva</li>
      <li data-action="edit">‚úèÔ∏è Editar</li>
      <li data-action="delete" class="delete">üóëÔ∏è Eliminar</li>
    </ul>
  </div>

  <script>
    const qs = s => document.querySelector(s);

    const projectGrid = qs('#project-grid');
    const addBtn = qs('#addBtn');
    const modal = qs('#modal');
    const modalTitle = qs('#modalTitle');
    const saveBtn = qs('#save');
    const cancelBtn = qs('#cancel');
    const pTitle = qs('#pTitle');
    const pURL = qs('#pURL');
    const pDesc = qs('#pDesc');
    const pIcon = qs('#pIcon');
    const contextMenu = qs('#contextMenu'); // Referencia al men√∫

    let projects = JSON.parse(localStorage.getItem('mv_projects_cards') || '[]');

    function renderList(){
      projectGrid.innerHTML='';
      if (!projects.length) {
        projectGrid.innerHTML = `<p style="color: rgba(230, 238, 248, 0.5);">No hay proyectos. ¬°Agrega el primero con el bot√≥n de arriba!</p>`;
        return;
      }
      
      projects.forEach((p, idx)=>{
        const card = document.createElement('div');
        card.className = 'project-card';
        card.dataset.url = p.url;
        card.innerHTML = `
          <div class="card-header">
            <div class="card-icon">${p.icon || '‚ú®'}</div>
            <div class="card-title">${escapeHtml(p.title)}</div>
          </div>
          <p class="card-desc">${escapeHtml(p.desc)}</p>
        `;
        card.style.animationDelay = `${idx * 100}ms`;
        projectGrid.appendChild(card);
      });
    }

    function escapeHtml(s){return (s||'').replace(/[&<>"']/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]))}

    // El clic normal abre en pesta√±a nueva
    projectGrid.addEventListener('click', e => {
      const card = e.target.closest('.project-card');
      if (card && card.dataset.url) {
        window.open(card.dataset.url, '_blank');
      }
    });
    
    // --- NUEVO: L√ìGICA DEL MEN√ö CONTEXTUAL ---

    // 1. Mostrar el men√∫ al hacer clic derecho en una tarjeta
    projectGrid.addEventListener('contextmenu', e => {
        e.preventDefault();
        const card = e.target.closest('.project-card');
        if (!card) return;

        const idx = Array.from(projectGrid.children).indexOf(card);
        if (idx < 0) return;

        contextMenu.dataset.idx = idx;
        contextMenu.style.display = 'block';
        contextMenu.style.left = `${e.pageX}px`;
        contextMenu.style.top = `${e.pageY}px`;
    });

    // 2. Ocultar el men√∫ al hacer clic en cualquier otro lado
    window.addEventListener('click', () => {
        contextMenu.style.display = 'none';
    });

    // 3. Manejar las acciones del men√∫
    contextMenu.addEventListener('click', e => {
        const action = e.target.dataset.action;
        const idx = parseInt(contextMenu.dataset.idx, 10);
        if (isNaN(idx)) return;

        if (action === 'open_new_tab') window.open(projects[idx].url, '_blank');
        if (action === 'edit') openEditModal(idx);
        if (action === 'delete') deleteProject(idx);
    });

    // --- FUNCIONES DE AGREGAR, EDITAR Y ELIMINAR ---
    
    function openEditModal(idx) {
        const p = projects[idx];
        modalTitle.textContent = "Editar Proyecto";
        pTitle.value = p.title;
        pURL.value = p.url;
        pDesc.value = p.desc;
        pIcon.value = p.icon;
        modal.style.display = 'flex';

        saveBtn.onclick = () => {
            projects[idx] = {
                title: pTitle.value.trim(),
                url: pURL.value.trim(),
                desc: pDesc.value.trim(),
                icon: pIcon.value.trim()
            };
            persist();
            closeModal();
            renderList();
        };
    }

    function deleteProject(idx) {
        if (confirm(`¬øEst√°s seguro de que quieres eliminar el proyecto "${projects[idx].title}"?`)) {
            projects.splice(idx, 1);
            persist();
            renderList();
        }
    }

    addBtn.addEventListener('click', () => {
      modalTitle.textContent = "Agregar Nuevo Proyecto";
      pTitle.value=''; pURL.value=''; pDesc.value=''; pIcon.value='';
      modal.style.display = 'flex';
      
      saveBtn.onclick = () => {
        const newProject = {
          title: pTitle.value.trim(),
          url: pURL.value.trim(),
          desc: pDesc.value.trim(),
          icon: pIcon.value.trim()
        };

        if (!newProject.title || !newProject.url || !newProject.desc) {
          alert('El t√≠tulo, la URL y la descripci√≥n son requeridos.');
          return;
        }
        projects.unshift(newProject);
        persist();
        closeModal();
        renderList();
      }
    });
    
    cancelBtn.addEventListener('click', closeModal);
    function closeModal(){ modal.style.display = 'none'; }
    function persist(){ localStorage.setItem('mv_projects_cards', JSON.stringify(projects)); }

    function loadSample(){
      projects = [
        {title:'Portafolio Personal', url:'https://github.com', desc: 'Un portafolio moderno para mostrar mis habilidades y proyectos principales.', icon: 'üë®‚Äçüíª'},
        {title:'Juego en Canvas', url:'https://github.com', desc: 'Un juego interactivo desarrollado con HTML5 Canvas y JavaScript puro.', icon: 'üéÆ'},
        {title:'App del Clima', url:'https://github.com', desc: 'Aplicaci√≥n que consume una API para mostrar el pron√≥stico del tiempo en tiempo real.', icon: 'üå¶Ô∏è'},
        {title:'E-commerce de Ropa', url:'https://github.com', desc: 'Tienda en l√≠nea con carrito de compras y pasarela de pago simulada.', icon: 'üëï'},
      ];
      persist();
    }

    if (!projects.length) loadSample();
    renderList();
  </script>
</body>
</html>